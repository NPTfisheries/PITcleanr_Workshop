<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Wrangling and Preparing PIT Tag Data using PITcleanr</title>
    <meta charset="utf-8" />
    <meta name="author" content="Kevin See, Ryan Kinzer, Mike Ackerman" />
    <meta name="date" content="2024-02-01" />
    <script src="PITcleanr_Presentation_files/header-attrs/header-attrs.js"></script>
    <link href="PITcleanr_Presentation_files/remark-css/default.css" rel="stylesheet" />
    <link href="PITcleanr_Presentation_files/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/htmlwidgets/htmlwidgets.js"></script>
    <link href="PITcleanr_Presentation_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/datatables-binding/datatables.js"></script>
    <script src="PITcleanr_Presentation_files/jquery/jquery-3.6.0.min.js"></script>
    <link href="PITcleanr_Presentation_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="PITcleanr_Presentation_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="PITcleanr_Presentation_files/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/nouislider/jquery.nouislider.min.js"></script>
    <link href="PITcleanr_Presentation_files/selectize/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/selectize/selectize.min.js"></script>
    <link href="PITcleanr_Presentation_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="PITcleanr_Presentation_files/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="tamu_custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Wrangling and Preparing PIT Tag Data using PITcleanr
]
.author[
### Kevin See, Ryan Kinzer, Mike Ackerman
]
.institute[
### WDFW <br/> Department of Fish Science <br/> <br/> Nez Perce Tribe <br/> Department of Fisheries Resources Management
]
.date[
### February 1, 2024
]

---




background-image: url(images/Chinook_spawner.jpeg)
background-size: cover

---

background-image: url('images/pit_tag_antenna.jpg'), url('images/logo.png')
background-position: top 10% right 10%, bottom 10% right 10%
background-size: 25%, 25%

# Today's Journey

* Benefits and challenges of PIT tag data

* PITcleanr: &lt;p&gt;https://github.com/kevinsee/PITcleanr/&lt;/p&gt;

  * Purpose

  * Functionality

  * Package resources

* Summary

---

class: inverse, center, middle

# PIT Tag Data

---

background-image: url('images/PITarray_flow.jpg')
background-size: cover

---

class: top

# PIT Tag Data

.pull-left[
### Benefits

Information about individual fish

* movement

* timing

* survival

&lt;center&gt;
&lt;img src="images/BiomarkFeatureSalmon.jpg" width="80%" /&gt;
&lt;/center&gt;

]

.pull-right[
### Challenges

* **TONS** of data

* Can be overwhelming

* E.g. One juvenile fish detected ***681*** times at single site within 12 hour period on Lemhi River 

&lt;center&gt;
&lt;img src="images/PITarray_flow.jpg" width="80%" /&gt;
&lt;/center&gt;

]

---

# So much data...


```r
# the complete tag history file from PTAGIS
ptagis_file &lt;- 
  system.file("extdata", 
              "TUM_chnk_cth_2018.csv", 
              package = "PITcleanr")

# read the complete tag history file into R
observations &lt;- 
  readCTH(ptagis_file,
          file_type = "PTAGIS")

n_distinct(observations$tag_code) # unique tag codes
```

```
## [1] 1406
```

```r
n_distinct(observations$event_site_code_value) # unique event sites
```

```
## [1] 50
```

```r
nrow(observations) # total observations
```

```
## [1] 13501
```




---

# So much data...

.tiny[
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e87ba04d3b329cda4501" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e87ba04d3b329cda4501">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1456828440000\" data-max=\"1530403576000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"160\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1457110800000\" data-max=\"1529162791000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720"],["NASONC","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO3","BO4","BO4","BO4","BO4","BO4","BO4","BO4","TD1","TD1","TD1","TD1","JO1","JO1","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","PRA","PRA","PRA","PRA","RIA","RIA","RIA","RIA","RIA","TUF","TUF","TUF","TUF","TUF","TUF","TUF","TUF","TUF","TUF","TUM","UWE","NAL","RIS","JDJ","JDJ","JDJ","JDJ","BO2","BO2","BO2","BO2","BO2","BO2","BO2","BO2","BO4","BO4","BO4","BO4","BO4","BO4","BO4","TD1","TD1","TD1","JO2","JO2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2","MC2"],["2016-03-01T10:34:00Z","2018-05-18T09:36:59Z","2018-05-18T09:37:11Z","2018-05-18T09:37:12Z","2018-05-18T09:42:16Z","2018-05-18T09:44:03Z","2018-05-18T11:38:57Z","2018-05-18T11:38:57Z","2018-05-18T11:38:57Z","2018-05-18T11:38:57Z","2018-05-18T11:59:43Z","2018-05-18T11:59:48Z","2018-05-18T11:59:49Z","2018-05-18T11:59:51Z","2018-05-18T11:59:52Z","2018-05-18T11:59:55Z","2018-05-18T11:59:56Z","2018-05-18T11:59:58Z","2018-05-18T12:00:05Z","2018-05-18T13:03:11Z","2018-05-18T13:06:22Z","2018-05-18T13:06:23Z","2018-05-18T13:08:01Z","2018-05-18T13:08:02Z","2018-05-18T13:09:28Z","2018-05-18T13:09:29Z","2018-05-20T17:20:39Z","2018-05-20T17:20:40Z","2018-05-20T17:20:43Z","2018-05-20T17:20:44Z","2018-05-21T17:49:21Z","2018-05-21T17:51:20Z","2018-05-24T09:04:38Z","2018-05-24T09:05:03Z","2018-05-24T09:09:20Z","2018-05-24T09:10:16Z","2018-05-24T09:14:27Z","2018-05-24T09:14:28Z","2018-05-24T09:20:28Z","2018-05-24T09:21:36Z","2018-05-24T09:54:49Z","2018-05-24T09:54:50Z","2018-05-24T09:54:51Z","2018-05-24T09:54:53Z","2018-05-28T13:58:51Z","2018-05-28T13:59:58Z","2018-05-28T14:00:51Z","2018-05-28T14:01:50Z","2018-05-30T15:56:55Z","2018-05-30T16:16:43Z","2018-05-30T16:22:02Z","2018-05-30T16:38:22Z","2018-05-30T16:38:55Z","2018-06-14T20:35:10Z","2018-06-15T11:57:41Z","2018-06-15T12:03:36Z","2018-06-15T12:10:04Z","2018-06-15T12:21:46Z","2018-06-15T15:57:55Z","2018-06-15T20:10:10Z","2018-06-16T12:04:25Z","2018-06-16T12:15:10Z","2018-06-16T12:22:30Z","2018-06-16T15:26:31Z","2018-06-23T22:03:13Z","2018-07-01T00:06:16Z","2016-04-13T09:00:00Z","2016-05-08T21:04:10Z","2016-05-08T21:04:12Z","2016-05-08T21:04:15Z","2016-05-08T21:04:18Z","2018-05-23T05:40:40Z","2018-05-23T05:43:20Z","2018-05-23T05:44:21Z","2018-05-23T05:44:22Z","2018-05-23T05:44:23Z","2018-05-23T05:51:23Z","2018-05-23T05:52:41Z","2018-05-23T05:55:17Z","2018-05-23T08:09:12Z","2018-05-23T08:09:13Z","2018-05-23T08:11:39Z","2018-05-23T08:11:40Z","2018-05-23T08:14:22Z","2018-05-23T08:14:23Z","2018-05-23T08:16:26Z","2018-05-25T08:31:16Z","2018-05-25T08:31:17Z","2018-05-25T08:31:22Z","2018-05-26T07:30:18Z","2018-05-26T07:30:22Z","2018-05-28T08:28:03Z","2018-05-28T08:33:03Z","2018-05-28T08:34:07Z","2018-05-28T08:37:49Z","2018-05-28T08:37:50Z","2018-05-28T08:40:10Z","2018-05-28T08:43:24Z","2018-05-28T08:44:58Z","2018-05-28T09:31:39Z"],[null,"18","16","16","14","12","22","24","26","28","10","0E","0E","0C","0C","0A","0A","08","06","04","03","03","02","02","01","01","02","02","01","01","08","04","13","11","0F","0C","09","09","07","05","03","02","02","01","04","03","04","01","06","06","05","06","05","A4","A4","A4","A4","A4","A4","A4","A3","A2","A1",null,"B2","63",null,"01","02","03","04","0F","0C","09","09","09","08","06","04","04","04","03","03","02","02","01","02","02","01","07","03","10","0E","0D","0A","0A","08","06","04","03"],[0,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,100,100,100,100,100,100,120,120,120,120,120,120,120,120,120,120,120,120,110,110,110,110,130,130,130,130,130,110,110,110,110,110,110,110,110,110,110,0,110,100,0,160,160,160,160,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,100,100,100,100,100,120,120,120,120,120,120,120,120,120],["Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook","Chinook"],["Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Wild Fish or Natural Production","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared","Hatchery Reared"],["Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation"],["River","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Dam","Instream Remote Detection System","Instream Remote Detection System","Dam","Juvenile Fish Bypass Facility","Juvenile Fish Bypass Facility","Juvenile Fish Bypass Facility","Juvenile Fish Bypass Facility","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway","Adult Fishway"],["NASONC",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"TUMFBY",null,null,"RI2BYP",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["2016-03-04T17:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2018-06-16T15:26:31Z",null,null,"2016-04-17T11:34:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Tag Code<\/th>\n      <th>Event Site Code Value<\/th>\n      <th>Event Date Time Value<\/th>\n      <th>Antenna Id<\/th>\n      <th>Antenna Group Configuration Value<\/th>\n      <th>Mark Species Name<\/th>\n      <th>Mark Rear Type Name<\/th>\n      <th>Event Type Name<\/th>\n      <th>Event Site Type Description<\/th>\n      <th>Event Release Site Code Code<\/th>\n      <th>Event Release Date Time Value<\/th>\n      <th>Cth Count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":300,"paging":false,"columnDefs":[{"className":"dt-right","targets":[5,12]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
]

---

class: inverse, center, middle

# PITcleanr Package

---
# PITcleanr Purpose

## Make your life easier

.pull-left[
* Query some data from PTAGIS
  * Metadata about sites
  * Configuration files
  * MRR files

* Read in data from PTAGIS or non-PTAGIS sources
  * Consistent format
  * Identify orphan or disowned tags
]

.pull-right[
* Compress observations
  * Reduce redundant detections

* Determine movement direction
  * Based on parent-child table
  * Includes tools to build parent-child table

* Estimate array/site efficiency  
]


---

class: inverse, center, middle

# Example Data

---




.pull-left[

# Adult Spring Chinook

* Tagged at Tumwater Dam on Wenatchee River as adults

* Goal is to estimate movement or survival past each site

]

.pull-right[
&lt;img src="images/TUM_site_map.png" width="70%" /&gt;
]

---

# Read in Data

Complete tag histories from PTAGIS

* Start with a list of tags
* Need certain columns


```r
print(cth_file_nm)
```

```
## [1] "TUM_chnk_cth_2018.csv"
```

--

Use `readCTH()` function:


```r
# read the complete tag history file into R
cth_df &lt;- 
  system.file("extdata", 
              cth_file_nm, 
              package = "PITcleanr") |&gt; 
* readCTH(file_type = "PTAGIS")
```

* PTAGIS not the only format
  * Biologic
  * Raw .log, .xlsx, or .txt files
* Change `file_type`

---

# Compress data

### Key feature of PITcleanr

Map each site / antenna to a *node*

Start with:
* 13,501 observations of 
* 1,406 unique tags from 
* 50 different sites. 


```r
comp_obs &lt;- compress(cth_df)
```

End with 4,435 rows of data. 
* 32.8% of original data

---

# Compress data

.small[
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-58d9fc028f11a37fe086" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-58d9fc028f11a37fe086">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"232\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1428926400000\" data-max=\"1535166402000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1428926400000\" data-max=\"1536129805000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","384.3B239AC47B","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD720","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DD725","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9DDAB0","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003B9F123C","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7A654","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC7F0E3","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80A3C","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81","3DD.003BC80D81"],["NASONC","BO3","BO4","TD1","JO1","MC2","PRA","RIA","TUF","TUM","UWE","NAL","RIS","JDJ","BO2","BO4","TD1","JO2","MC2","PRA","RIA","TUF","TUM","RIS","BO3","BO4","TD1","JO1","MC2","PRA","LWE","TUF","TUM","CHU","CHIWAT","BO1","TD1","JO2","MC1","PRA","RIA","TUF","TUM","EBNK","BO2","BO4","TD1","JO2","MC2","PRA","TUF","TUM","UWE","NASONC","B2J","BO3","BO4","TD1","JO2","MC1","PRA","RIA","TUF","TUM","UWE","NAL","NAU","NASONC","MCJ","BO3","BO4","TD1","JO1","MC2","PRA","LWE","TUF","TUM","UWE","NAL","NAU","NASONC","JDJ","BO1","TD1","JO2","MC1","PRA","TUF","TUM","UWE","NAL","NASONC","MCJ","BO3","BO4","TD1","JO2","MC2","PRA"],[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8],["Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Observation","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Observation","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation","Recapture","Observation","Observation","Mark","Observation","Observation","Observation","Observation","Observation","Observation","Observation"],[1,18,7,4,2,12,4,5,10,1,1,1,1,4,8,7,3,2,15,2,3,9,1,1,11,9,3,4,12,2,2,7,1,1,1,19,3,2,15,2,1,4,1,1,10,8,6,2,15,2,3,1,1,1,10,16,9,4,2,15,2,3,7,1,1,2,11,1,4,14,8,2,2,11,2,2,8,1,1,1,232,1,12,22,20,2,45,2,6,1,1,1,1,4,13,9,3,2,15,2],["2016-03-04T17:00:00Z","2018-05-18T09:36:59Z","2018-05-18T13:03:11Z","2018-05-20T17:20:39Z","2018-05-21T17:49:21Z","2018-05-24T09:04:38Z","2018-05-28T13:58:51Z","2018-05-30T15:56:55Z","2018-06-14T20:35:10Z","2018-06-16T15:26:31Z","2018-06-23T22:03:13Z","2018-07-01T00:06:16Z","2016-04-17T11:34:00Z","2016-05-08T21:04:10Z","2018-05-23T05:40:40Z","2018-05-23T08:09:12Z","2018-05-25T08:31:16Z","2018-05-26T07:30:18Z","2018-05-28T08:28:03Z","2018-06-01T18:15:01Z","2018-06-04T06:31:44Z","2018-06-15T20:35:15Z","2018-06-17T09:39:26Z","2016-04-16T12:00:00Z","2018-05-07T17:43:26Z","2018-05-07T18:55:59Z","2018-05-10T17:08:40Z","2018-05-12T16:57:07Z","2018-05-16T16:21:59Z","2018-05-25T13:43:20Z","2018-05-29T19:53:58Z","2018-06-18T19:58:39Z","2018-06-19T09:33:08Z","2018-06-28T21:34:58Z","2015-11-05T08:40:00Z","2018-06-07T17:42:59Z","2018-06-09T11:33:46Z","2018-06-16T07:52:18Z","2018-06-27T09:20:15Z","2018-07-01T08:59:42Z","2018-07-05T16:16:42Z","2018-07-17T08:24:58Z","2018-07-17T11:51:44Z","2015-04-13T12:00:00Z","2018-05-24T16:23:59Z","2018-05-24T18:20:45Z","2018-05-28T06:15:01Z","2018-05-29T06:13:10Z","2018-05-31T09:29:04Z","2018-06-04T08:16:28Z","2018-06-20T21:17:28Z","2018-06-21T09:45:14Z","2018-07-01T12:55:31Z","2016-04-18T20:00:00Z","2016-05-06T20:32:54Z","2018-05-07T08:14:59Z","2018-05-07T09:58:26Z","2018-05-09T12:14:19Z","2018-05-10T12:26:49Z","2018-05-12T11:56:44Z","2018-05-18T17:54:10Z","2018-05-21T06:41:57Z","2018-06-09T10:21:41Z","2018-06-09T22:36:03Z","2018-06-16T06:46:29Z","2018-06-16T23:28:31Z","2018-08-25T03:06:42Z","2016-04-18T20:00:00Z","2016-05-01T19:44:11Z","2018-05-27T07:42:31Z","2018-05-27T08:58:59Z","2018-05-29T10:24:38Z","2018-05-30T15:17:53Z","2018-06-02T08:34:36Z","2018-06-07T10:33:42Z","2018-06-10T18:25:16Z","2018-06-28T16:01:28Z","2018-06-28T18:49:05Z","2018-07-05T20:32:44Z","2018-07-06T02:04:23Z","2018-07-12T20:32:29Z","2016-04-18T20:00:00Z","2016-05-13T11:34:57Z","2018-05-26T15:29:26Z","2018-05-28T17:59:13Z","2018-05-29T15:08:27Z","2018-06-01T16:51:49Z","2018-06-06T17:56:16Z","2018-06-20T17:30:39Z","2018-06-22T07:40:08Z","2018-07-04T09:23:06Z","2018-07-05T02:45:34Z","2016-04-18T20:00:00Z","2016-05-05T20:23:39Z","2018-05-19T12:12:09Z","2018-05-19T13:39:55Z","2018-05-22T17:26:39Z","2018-05-23T17:27:26Z","2018-05-26T12:05:03Z","2018-06-01T15:34:16Z"],["2016-03-04T17:00:00Z","2018-05-18T12:00:05Z","2018-05-18T13:09:29Z","2018-05-20T17:20:44Z","2018-05-21T17:51:20Z","2018-05-24T09:54:53Z","2018-05-28T14:01:50Z","2018-05-30T16:38:55Z","2018-06-16T12:22:30Z","2018-06-16T15:26:31Z","2018-06-23T22:03:13Z","2018-07-01T00:06:16Z","2016-04-17T11:34:00Z","2016-05-08T21:04:18Z","2018-05-23T05:55:17Z","2018-05-23T08:16:26Z","2018-05-25T08:31:22Z","2018-05-26T07:30:22Z","2018-05-28T09:31:49Z","2018-06-01T18:16:59Z","2018-06-04T06:55:42Z","2018-06-17T06:02:47Z","2018-06-17T09:39:26Z","2016-04-16T12:00:00Z","2018-05-07T18:17:25Z","2018-05-07T19:01:04Z","2018-05-10T17:08:44Z","2018-05-12T16:57:14Z","2018-05-16T17:19:14Z","2018-05-25T13:46:46Z","2018-05-29T19:54:15Z","2018-06-18T21:30:43Z","2018-06-19T09:33:08Z","2018-06-28T21:34:58Z","2015-11-05T08:40:00Z","2018-06-07T18:59:38Z","2018-06-09T11:33:52Z","2018-06-16T07:52:23Z","2018-06-27T17:59:30Z","2018-07-01T09:03:14Z","2018-07-05T16:16:42Z","2018-07-17T08:48:17Z","2018-07-17T11:51:44Z","2015-04-13T12:00:00Z","2018-05-24T16:34:21Z","2018-05-24T18:30:35Z","2018-05-28T06:15:54Z","2018-05-29T06:13:16Z","2018-05-31T10:24:21Z","2018-06-04T08:25:34Z","2018-06-21T04:57:13Z","2018-06-21T09:45:14Z","2018-07-01T12:55:31Z","2016-04-18T20:00:00Z","2016-05-06T20:34:39Z","2018-05-07T09:29:40Z","2018-05-07T10:03:06Z","2018-05-09T12:14:25Z","2018-05-10T12:26:54Z","2018-05-12T13:24:18Z","2018-05-18T17:56:49Z","2018-05-21T06:45:44Z","2018-06-09T15:35:27Z","2018-06-09T22:36:03Z","2018-06-16T06:46:29Z","2018-07-08T01:07:49Z","2018-09-03T19:05:28Z","2016-04-18T20:00:00Z","2016-05-01T19:44:21Z","2018-05-27T08:19:26Z","2018-05-27T09:08:07Z","2018-05-29T10:24:41Z","2018-05-30T15:18:00Z","2018-06-02T09:24:34Z","2018-06-07T10:36:54Z","2018-06-10T18:25:42Z","2018-06-28T16:44:10Z","2018-06-28T18:49:05Z","2018-07-05T20:32:44Z","2018-07-06T02:04:23Z","2018-09-05T06:43:25Z","2016-04-18T20:00:00Z","2016-05-13T11:36:14Z","2018-05-26T17:00:19Z","2018-05-28T18:07:05Z","2018-05-29T15:08:51Z","2018-06-01T19:39:06Z","2018-06-06T17:58:45Z","2018-06-21T09:29:34Z","2018-06-22T07:40:08Z","2018-07-04T09:23:06Z","2018-07-05T02:45:34Z","2016-04-18T20:00:00Z","2016-05-05T20:23:48Z","2018-05-19T13:00:49Z","2018-05-19T13:43:45Z","2018-05-22T17:26:45Z","2018-05-23T17:29:18Z","2018-05-26T13:10:34Z","2018-06-01T15:38:17Z"],[0,143.1,6.3,0.1,2,50.2,3,42,2387.3,0,0,0,0,0.1,14.6,7.2,0.1,0.1,63.8,2,24,2007.5,0,0,34,5.1,0.1,0.1,57.2,3.4,0.3,92.1,0,0,0,76.7,0.1,0.1,519.2,3.5,0,23.3,0,0,10.4,9.8,0.9,0.1,55.3,9.1,459.8,0,0,0,1.8,74.7,4.7,0.1,0.1,87.6,2.6,3.8,313.8,0,0,30339.3,13918.8,0,0.2,36.9,9.1,0,0.1,50,3.2,0.4,42.7,0,0,0,78370.9,0,1.3,90.9,7.9,0.4,167.3,2.5,958.9,0,0,0,0,0.1,48.7,3.8,0.1,1.9,65.5,4],[null,1158757,63.1,3131.2,1468.6,3793.3,6004,2995.1,21836.2,184,10476.7,10203,null,30810.2,1071876.4,133.9,2894.8,1378.9,2937.7,6283.2,3614.8,16659.6,216.7,null,1081783.4,38.6,4207.6,2868.4,5724.8,12744.1,6127.2,28804.4,722.4,13681.8,null,1361343,2434.1,9858.4,15927.9,5220.2,6193.5,16808.3,183.4,null,1637544,106.4,5024.4,1437.3,3075.8,5632.1,23811.9,288,14590.3,null,25952.9,1051900.3,28.8,3011.2,1452.4,2849.8,8909.9,3645.1,27576,420.6,9130.4,1002,69238.9,null,18704.2,1087918.2,39.5,2956.5,1733.2,3916.6,7269.1,4788.4,25775.8,124.9,10183.6,331.6,9748.1,null,35494.9,1070153.2,2938.9,1261.4,4423,7097.2,20131.9,1330.6,17383,1042.5,null,24503.7,1070868.4,39.1,4542.9,1440.7,3995.8,8783.7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Tag Code<\/th>\n      <th>Node<\/th>\n      <th>Slot<\/th>\n      <th>Event Type Name<\/th>\n      <th>N Dets<\/th>\n      <th>Min Det<\/th>\n      <th>Max Det<\/th>\n      <th>Duration<\/th>\n      <th>Travel Time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":300,"paging":false,"columnDefs":[{"className":"dt-right","targets":[3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
]

---

# Compress data

.large[
1. Shrink size of data

1. Assign observations to node of your choice

1. First, last and number of detections on each node

1. Total duration between first and last detections

1. Travel time from previous node
]

---

class: inverse, center, middle

# Configuration File

---

# Configuration file

Map each detection to a user-defined node

Node could be:
* Individual antenna
* Array (group of antennas)
* Site
* Group of sites

--

Can use PTAGIS site metadata to construct


```r
my_config &lt;- buildConfig(node_assign = "site")
```

---

# Configuration file

Essential columns

.small[
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-936afcc8a31f9fdabcb7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-936afcc8a31f9fdabcb7">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"100\" data-max=\"140\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],["0HR","0HR","0HR","158","158","158","158","158","158","15D","15D","15D","15D","15D","15D","15R","15R","15R","15R","15R","15R","18M","18M","18M","18M","18M","18M","18M","18N","18N","18N","18N","1BC","1BC","1BC","1BC","1LC","1LC","1LC","1LC","1TC","2BC","2BC","2BC","2BC","2LC","2LC","2LC","2LC","30M","30M","30M","30M","3D1","3D2","3D3","3D4","85M","85M","85M","85M","85M","85M","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB2","AB2","AB2","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB4","AB4","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","AEN","AEN","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AGC","AGC","AGC","AH1","AH1","ANR","ANT","ANT","ANT","ANT","ANT","ANT","ANT","B1J","B1J","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2J","B2J","B2J","B2J"],["01","02","03","D1","D2","D3","D4","D5","D6","C1","C2","C3","C4","C5","C6","E1","E2","E3","E4","E5","E6","01","02","03","01","02","01","02","A1","A2","A3","A1","01","02","01","02","01","02","01","02","01","03","04","03","04","03","04","03","04","01","02","01","02","10","11","12","13","F1","F2","F3","F4","F5","F6","A1","A2","A3","01","02","03","04","0I","0N","0T","1","2","FA","G2","F1","F2","F3","F4","F5","F6","01","02","01","02","03","04","0A","B1","B2","01","02","03","F1","F2","F3","F4","02","03","04","06","02","01","04","03","01","02","03","04","F1","F2","01","02","03","04","05","01","02","03","01","02","03","04","F1","F2","F3","F4","01","02","03","04","05","06","A1","01","01","02","03","04","05","06","01","02","03","04","05","06","01","02","03","01","02","01","11","12","13","14","11","12","13","01","02","00","02","04","06","10","12","14","16","28","2A","2E","4C","4E","AA","BB","C1","C2","CC","DD","00","02","04","10","12","14","A1","A2","A3","A4","A5","B4","B5","D0","00","02","04"],[100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,110,110,120,120,100,100,100,110,100,100,110,110,100,100,110,110,100,100,100,110,110,100,100,110,110,100,100,110,110,100,100,100,100,100,100,100,100,100,100,100,100,100,110,110,110,110,110,110,110,110,110,110,110,120,120,120,120,120,120,130,130,140,140,140,140,100,100,100,100,100,100,110,110,110,110,120,120,120,120,130,130,130,130,140,140,140,140,100,100,100,100,100,100,100,110,110,110,120,120,120,120,100,100,100,100,110,110,110,110,110,110,100,110,100,100,100,100,100,100,110,110,110,110,110,110,100,100,100,100,100,100,100,100,100,100,110,110,110,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,110,110,110,110,110,110,110,110,110,110,110,110,110,100,110,110,110],["0HR","0HR","0HR","158","158","158","158","158","158","15D","15D","15D","15D","15D","15D","15R","15R","15R","15R","15R","15R","18M","18M","18M","18M","18M","18M","18M","18N","18N","18N","18N","1BC","1BC","1BC","1BC","1LC","1LC","1LC","1LC","1TC","2BC","2BC","2BC","2BC","2LC","2LC","2LC","2LC","30M","30M","30M","30M","3D1","3D2","3D3","3D4","85M","85M","85M","85M","85M","85M","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB1","AB2","AB2","AB2","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB3","AB4","AB4","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACB","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","ACM","AEN","AEN","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AFC","AGC","AGC","AGC","AH1","AH1","ANR","ANT","ANT","ANT","ANT","ANT","ANT","ANT","B1J","B1J","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2A","B2J","B2J","B2J","B2J"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Site Code<\/th>\n      <th>Antenna Id<\/th>\n      <th>Config Id<\/th>\n      <th>Node<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":300,"paging":false,"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
]

---

# Configuration file

But PTAGIS columns include:


```r
names(my_config) |&gt; 
  janitor::make_clean_names("title")
```

```
##  [1] "Site Code"        "Config Id"        "Antenna Id"       "Node"            
##  [5] "Start Date"       "End Date"         "Site Type"        "Site Name"       
##  [9] "Antenna Group"    "Site Description" "Site Type Name"   "Rkm"             
## [13] "Rkm Total"        "Latitude"         "Longitude"
```

---

class: inverse, center, middle

# Directionality

---




.pull-left[

# Map of Sites

* Which sites are upstream / downstream of one another?
* What are possible paths a fish might take? 
]

.pull-right[
&lt;img src="images/TUM_site_map.png" width="70%" /&gt;
]

---

# Parent-Child Table

.pull-left[

* Moving upstream, tags move from parent sites to child sites

* Details which sites are upstream of a particular site

* Can be reversed for downstream movement

* Can be made by hand...

* `PITcleanr` has tools to help
]

.pull-right[


```r
parent_child |&gt; 
  select(parent, child)
```

```
## # A tibble: 14 x 2
##    parent child
##    &lt;chr&gt;  &lt;chr&gt;
##  1 ICL    LNF  
##  2 ICL    ICM  
##  3 TUM    ICL  
##  4 TUM    UWE  
##  5 TUM    CHL  
##  6 TUM    PES  
##  7 TUM    CHW  
##  8 ICM    ICU  
##  9 UWE    LWN  
## 10 UWE    WTL  
## 11 UWE    NAL  
## 12 CHL    CHU  
## 13 PES    PEU  
## 14 NAL    NAU
```

]

???
Fairly simple example
Easy enough to enter by hand directly into R, or type up in Excel
Can get much more complicated

---

# Parent-Child Table

* PITcleanr has a `buildParentChild()` function.

* Requires an `sf` point object of sites
  * Build yourself or use `extractSites()`

* Requires an `sf` line object of the NHDPlus flowlines, downloaded from USGS.
  * Use `queryFlowlines()` to download it

---

# Build `sf` object of sites

### One way


```r
# extract sites from detection file
sites_sf &lt;-
  extractSites(cth_file = cth_df,
               as_sf = T,
               # drop juvenile detection/marking sites
               min_date = "20180501")

# focus on sites within Wenatchee subbasin, and drop a few sites we don't care about
sites_sf &lt;- 
  sites_sf %&gt;%
  # all sites in the Wenatchee have a river kilometer that starts with 754
  filter(str_detect(rkm, "^754."),
         type != "MRR",
         site_code != "LWE") |&gt; 
  mutate(across(site_code,
                ~ recode(.,
                         "TUF" = "TUM")))
```

---

# Build `sf` object of sites

### Another way


```r
# type site codes by hand
sites_sf &lt;-
  tibble(site_code = 
           c("ICL", "TUM", "ICM", "UWE", "CHL", "PES", "NAL", 
             "LNF", "CHW", "ICU", "LWN", "WTL", "CHU", "PEU", 
             "NAU")) |&gt; 
  left_join(my_config |&gt; 
              select(site_code,
                     site_name,
                     site_type_name,
                     site_type,
                     rkm,
                     site_description,
                     latitude,
                     longitude) |&gt; 
              distinct(),
            by = join_by(site_code)) |&gt; 
  st_as_sf(coords = c("longitude",
                      "latitude"),
           crs = 4326) |&gt; 
  arrange(rkm)
```

---

# Query Flowlines

.pull-left[


```r
# query the flowlines
nhd_list &lt;-
  queryFlowlines(sites_sf = sites_sf,
                 root_site_code = "TUM",
                 min_strm_order = 2,
                 dwnstrm_sites = T,
                 dwn_min_stream_order_diff = 2)

# join the upstream and downstream flowlines
flowlines &lt;-
  nhd_list$flowlines %&gt;%
  rbind(nhd_list$dwn_flowlines)
```

]

.pull-right[


```r
flowlines |&gt; 
  st_drop_geometry() |&gt; 
  select(COMID,
         Hydroseq,
         UpHydroseq,
         DnHydroseq)
```

```
## # A tibble: 386 x 4
##       COMID Hydroseq UpHydroseq DnHydroseq
##       &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 23080784 50063945   50070238   50058967
##  2 23080786 50070238   50078399   50063945
##  3 23080788 50078399   50089588   50070238
##  4 23080790 50089588   50106483   50078399
##  5 23080792 50106483   50137781   50089588
##  6 23080794 50137781   50220575   50106483
##  7 23081176 50089577   50106469   50078388
##  8 23080910 50106479   50137746   50033323
##  9 23081092 50031394   50032319   50030525
## 10 23081090 50030525   50031394   50029716
## # i 376 more rows
```

]

---

# Build Parent-Child Table

.pull-left[


```r
parent_child &lt;-
  suppressWarnings(
    buildParentChild(sites_sf,
                     flowlines))
```


```r
parent_child &lt;-
  editParentChild(parent_child,
                  fix_list = 
                    list(c(NA, "PES", "TUM"),
                         c(NA, "LNF", "ICL"),
                         c(NA, "ICL", "TUM"),
                         c("PES", "ICL", "TUM")),
                  switch_parent_child = 
                    list(c("ICL", 'TUM')))
```

]

.pull-right[


```r
# view corrected parent_child table
parent_child |&gt; 
  select(parent, child)
```

```
## # A tibble: 14 x 2
##    parent child
##    &lt;chr&gt;  &lt;chr&gt;
##  1 ICL    LNF  
##  2 ICL    ICM  
##  3 TUM    ICL  
##  4 TUM    UWE  
##  5 TUM    CHL  
##  6 TUM    PES  
##  7 TUM    CHW  
##  8 ICM    ICU  
##  9 UWE    LWN  
## 10 UWE    WTL  
## 11 UWE    NAL  
## 12 CHL    CHU  
## 13 PES    PEU  
## 14 NAL    NAU
```

]

---

# Plot Parent-Child Table

.pull-left[


```r
plotNodes(parent_child,
          point_size = 10,
          label_size = 5)
```

![](PITcleanr_Presentation_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;

]

.pull-right[

All possible fish pathways


```r
buildNodeOrder(parent_child)
```

```
## # A tibble: 15 x 3
##    node  node_order path           
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;          
##  1 TUM            1 TUM            
##  2 CHL            2 TUM CHL        
##  3 CHU            3 TUM CHL CHU    
##  4 CHW            2 TUM CHW        
##  5 ICL            2 TUM ICL        
##  6 ICM            3 TUM ICL ICM    
##  7 ICU            4 TUM ICL ICM ICU
##  8 LNF            3 TUM ICL LNF    
##  9 PES            2 TUM PES        
## 10 PEU            3 TUM PES PEU    
## 11 UWE            2 TUM UWE        
## 12 LWN            3 TUM UWE LWN    
## 13 NAL            3 TUM UWE NAL    
## 14 NAU            4 TUM UWE NAL NAU
## 15 WTL            3 TUM UWE WTL
```

]

---

# Add Direction


```r
comp_dir &lt;-
  addDirection(compress_obs = comp_obs,
               parent_child = parent_child)

comp_dir |&gt; 
  select(tag_code,
         node,
         min_det,
         node_order,
         path,
         direction)
```

```
## # A tibble: 3,257 x 6
##    tag_code       node  min_det             node_order path        direction
##    &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;                   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    
##  1 384.3B239AC47B TUM   2018-06-16 15:26:31          1 TUM         start    
##  2 384.3B239AC47B UWE   2018-06-23 22:03:13          2 TUM UWE     forward  
##  3 384.3B239AC47B NAL   2018-07-01 00:06:16          3 TUM UWE NAL forward  
##  4 3DD.003B9DD720 TUM   2018-06-17 09:39:26          1 TUM         start    
##  5 3DD.003B9DD725 TUM   2018-06-19 09:33:08          1 TUM         start    
##  6 3DD.003B9DD725 CHU   2018-06-28 21:34:58          3 TUM CHL CHU forward  
##  7 3DD.003B9DDAB0 TUM   2018-07-17 11:51:44          1 TUM         start    
##  8 3DD.003B9F123C TUM   2018-06-21 09:45:14          1 TUM         start    
##  9 3DD.003B9F123C UWE   2018-07-01 12:55:31          2 TUM UWE     forward  
## 10 3DD.003BC7A654 TUM   2018-06-09 22:36:03          1 TUM         start    
## # i 3,247 more rows
```

---

# Strange Directions

![](PITcleanr_Presentation_files/figure-html/unnamed-chunk-23-1.png)&lt;!-- --&gt;


```
## # A tibble: 8 x 6
##   tag_code       node  min_det             node_order path            direction
##   &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;                   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;    
## 1 3DD.003BC80D81 TUM   2018-06-21 16:14:26          1 TUM             start    
## 2 3DD.003BC80D81 UWE   2018-06-29 15:29:19          2 TUM UWE         forward  
## 3 3DD.003BC80D81 NAL   2018-06-30 01:35:27          3 TUM UWE NAL     forward  
## 4 3DD.003BC80D81 LWN   2018-07-05 23:05:02          3 TUM UWE LWN     unknown  
## 5 3DD.003BC80D81 NAL   2018-07-08 03:06:42          3 TUM UWE NAL     unknown  
## 6 3DD.003BC80D81 UWE   2018-07-17 21:52:42          2 TUM UWE         backward 
## 7 3DD.003BC80D81 NAL   2018-07-20 21:50:13          3 TUM UWE NAL     forward  
## 8 3DD.003BC80D81 NAU   2018-07-30 22:40:06          4 TUM UWE NAL NAU forward
```


---

# Filter Observations


```r
comp_filter &lt;- filterDetections(compress_obs = comp_obs,
                                parent_child = parent_child,
                                max_obs_date = "20180930")

comp_filter |&gt; 
  select(tag_code, node, min_det, direction,
         ends_with("keep_obs"))
```

```
## # A tibble: 3,257 x 6
##    tag_code      node  min_det             direction auto_keep_obs user_keep_obs
##    &lt;chr&gt;         &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;     &lt;lgl&gt;         &lt;lgl&gt;        
##  1 384.3B239AC4~ TUM   2018-06-16 15:26:31 start     TRUE          TRUE         
##  2 384.3B239AC4~ UWE   2018-06-23 22:03:13 forward   TRUE          TRUE         
##  3 384.3B239AC4~ NAL   2018-07-01 00:06:16 forward   TRUE          TRUE         
##  4 3DD.003B9DD7~ TUM   2018-06-17 09:39:26 start     TRUE          TRUE         
##  5 3DD.003B9DD7~ TUM   2018-06-19 09:33:08 start     TRUE          TRUE         
##  6 3DD.003B9DD7~ CHU   2018-06-28 21:34:58 forward   TRUE          TRUE         
##  7 3DD.003B9DDA~ TUM   2018-07-17 11:51:44 start     TRUE          TRUE         
##  8 3DD.003B9F12~ TUM   2018-06-21 09:45:14 start     TRUE          TRUE         
##  9 3DD.003B9F12~ UWE   2018-07-01 12:55:31 forward   TRUE          TRUE         
## 10 3DD.003BC7A6~ TUM   2018-06-09 22:36:03 start     TRUE          TRUE         
## # i 3,247 more rows
```


```r
comp_filter |&gt; 
  filter(is.na(user_keep_obs)) |&gt; 
  select(tag_code) |&gt; 
  distinct() |&gt; 
  slice(1) |&gt; 
  left_join(comp_filter |&gt; 
              select(tag_code, 
                     node, 
                     min_det, 
                     direction,
                     ends_with("keep_obs")),
            by = join_by(tag_code))
```

```
## # A tibble: 8 x 6
##   tag_code       node  min_det             direction auto_keep_obs user_keep_obs
##   &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;     &lt;lgl&gt;         &lt;lgl&gt;        
## 1 3DD.003BC80D81 TUM   2018-06-21 16:14:26 start     TRUE          NA           
## 2 3DD.003BC80D81 UWE   2018-06-29 15:29:19 forward   FALSE         NA           
## 3 3DD.003BC80D81 NAL   2018-06-30 01:35:27 forward   FALSE         NA           
## 4 3DD.003BC80D81 LWN   2018-07-05 23:05:02 unknown   FALSE         NA           
## 5 3DD.003BC80D81 NAL   2018-07-08 03:06:42 unknown   FALSE         NA           
## 6 3DD.003BC80D81 UWE   2018-07-17 21:52:42 backward  TRUE          NA           
## 7 3DD.003BC80D81 NAL   2018-07-20 21:50:13 forward   TRUE          NA           
## 8 3DD.003BC80D81 NAU   2018-07-30 22:40:06 forward   TRUE          NA
```


---

# Capture Histories


```r
buildCapHist(comp_filter,
             parent_child = parent_child,
             configuration = my_config)
```

```
## # A tibble: 1,406 x 2
##    tag_code       cap_hist       
##    &lt;chr&gt;          &lt;chr&gt;          
##  1 384.3B239AC47B 100000000010100
##  2 3DD.003B9DD720 100000000000000
##  3 3DD.003B9DD725 101000000000000
##  4 3DD.003B9DDAB0 100000000000000
##  5 3DD.003B9F123C 100000000010000
##  6 3DD.003BC7A654 100000000010110
##  7 3DD.003BC7F0E3 100000000010110
##  8 3DD.003BC80A3C 100000000010100
##  9 3DD.003BC80D81 100000000010110
## 10 3DD.003BC80F20 100000000000100
## # i 1,396 more rows
```


```r
defineCapHistCols(parent_child = parent_child,
                  configuration = my_config)
```

```
##  [1] "TUM" "CHL" "CHU" "CHW" "ICL" "ICM" "ICU" "LNF" "PES" "PEU" "UWE" "LWN"
## [13] "NAL" "NAU" "WTL"
```



---

class: inverse, center, middle

# Package Resources

---

# Package Website

* https://kevinsee.github.io/PITcleanr/
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "magula",
"highlightLines": true,
"slideNumberFormat": "%current%",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
